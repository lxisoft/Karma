<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<title>Home</title>
	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<!-- Bootstrap core CSS -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet">
	<!-- Material Design Bootstrap -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.11/css/mdb.min.css" rel="stylesheet">
</head>

<body>
	<div>
	<nav class="navbar fixed-top navbar-expand-lg navbar-dark info-color scrolling-navbar">
		<a class="navbar-brand" th:href="@{/home/approved}"><strong>Karma</strong></a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
		 aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarSupportedContent">
			<ul class="navbar-nav mr-auto">
				<li class="nav-item active"><a class="nav-link" th:href="@{/home/approved}">Home
						<span class="sr-only">(current)</span>
					</a></li>
				<!-- <li class="nav-item"><a class="nav-link" th:href="@{/categories}">I need help</a></li> -->
				<li class="nav-item"><a class="nav-link" th:href="@{/home/pending}">Unapproved needs</a></li>
				<!-- <li class="nav-item"><a class="nav-link" th:href="@{/helps/completed}">Helps</a></li> -->
				<li class="nav-item"><a class="nav-link" th:href="@{/helps/incompleted}">Incomplete
						helps</a></li>
			</ul>
			<ul class="navbar-nav nav-flex-icons">
				<li class="nav-item"><a class="nav-link"><i class="fa fa-facebook"></i></a></li>
				<li class="nav-item"><a class="nav-link"><i class="fa fa-twitter"></i></a></li>
				<li class="nav-item"><a class="nav-link"><i class="fa fa-instagram"></i></a></li>
			</ul>
		</div>
	</nav>
</div>

	<!-- Material form login -->
	<!-- Default form login -->
	<div class="container-fluid">
		<!--<div class="row mx-auto mt-5">
			<div class="col-sm-8"></div>
			<a th:href="@{/categories}" class="btn btn-info">I need help</a> <a
				th:href="@{/home/pending}" class="btn btn-info">See pending help requests</a>
		</div>-->
		<div class="row mt-4"></div>
		<div class="row mt-5">
			<!-- 			<div class="col-sm-8">
				<div th:each="need : ${needs}" class="row my-3">
					<div class="card border-info mb-3 mx-auto"
						style="width: 75%">
						<div th:text="'posted on '+${need.date}" class="card-header"></div>
						<div class="card-body text-info">
							<h5 class="card-title">Need help</h5>
							<p class="card-text" th:text="${need.description}">Some quick
								example text to build on the card title and make up the bulk of
								the card's content.</p>
							<p th:if="${need.beneficiaryType != 'you'}">help is for
								someone else</p>
							<div>
							</div>
						</div>
					</div>
				</div>
			</div> -->
			<div class="col-sm-6 mx-auto">
                    <ul class="nav nav-pills nav-fill">
                            <li class="nav-item">
                              <a class="nav-link  info-color active" href="#">Needs</a>
                            </li>
							<li class="nav-item">
							  <a class="nav-link text-info" href="#">News Feeds</a>
							</li>
							</ul>
							<form id="need-post"class="border border-light mt-3 p-2" th:action="@{/needs}" th:method="post">

								<div class="md-form mt-0 mx-3 form-info mb-0">
									<textarea type="text" id="need-post-description" class="md-textarea form-control" rows="1" onclick="$('#need-post-extended').show();"
										placeholder="Do you need help? Post here" th:name="description"></textarea>
								</div>
								<!--					<label class="btn-bs-file btn btn-info"> Browse files <input
									type="file" name="image" multiple>
								</label>-->
								<div id="need-post-extended" style="display:none">
								<div> 
									<select class="mdb-select md-form mx-3" name="categoryList[0].id">
										 <th:block th:each="category : ${categories}">
										<!-- <th:block th:each="category : ${categories}">-->
										<optgroup th:label="${category.name}">
											<option  th:value="${category.id}" th:text="${category.subCategory}">Option 1</option>
										</optgroup>
										</th:block>
									</select><label class="text-info">Category</label>
									</div>
								<select
									class="mdb-select md-form colorful-select dropdown-primary mx-3 mt-0" th:name="beneficiaryType">
									<option value="you">you</option>
									<option value="someone else">someone else</option>
								</select><label class="text-info">Beneficiary type</label>
								
								 <!-- file upload -->
	<!-- 							 <div class="input-group mx-3 w-75">
									<div class="input-group-prepend">
									  <span class="input-group-text" id="inputGroupFileAddon01">Upload</span>
									</div>
									<div class="custom-file">
									  <input type="file" class="custom-file-input" id="inputGroupFile01" aria-describedby="inputGroupFileAddon01">
									  <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
									</div>
								  </div> -->
			
								<!-- Send button -->
								<input type=hidden th:name="dateInString" th:value="${#dates.format(#dates.createNow(), 'yyyy-MM-dd HH:mm:ss')}">
								<button class="btn btn-info btn-sm w-50 my-3 mx-auto btn-block" name="submit" type="submit">Post</button><i onclick="$('#need-post-extended').hide();" class="fa fa-close mx-auto" aria-hidden="true"></i>
								</div>
			
							</form>
				<div th:each="need,index : ${needs}" class="row my-3" th:fragment="needs" th:id="needs">
					<div class="card" style="width:100%" th:fragment="'need-'+${index}" th:id="'need-'+${need.id}">
						<div class="card-body">
							<form th:action="@{/user-checks/markingGenuinenes}" th:id="'usercheck'+${need.id}">
								<input type="hidden" name="id" th:value="${need.id}" id="'genuine'+${need.id}">
								<input type="hidden" name="postedUser" th:value="${need.postedUserId}">
								<input type="hidden" name="isGenuine" value="true">
							</form>
							<!--<i class="fa fa-ellipsis-v" aria-hidden="true">-->
							<div class="dropleft float-right">
								<button type="button" style="border-width:0px!important;outline:0px;box-shadow:0px!important;" class="btn-white"
								 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
									<i class="fa fa-ellipsis-v"></i>
									<span class="sr-only">Toggle Dropdown</span>
								</button>
								<div class="dropdown-menu">
									<a class="dropdown-item" th:onclick="|markGenuine(${need.id})|">Mark as genuine</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item" th:onclick="|markFake(${need.id})|">Mark as fake</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item">Help later</a>
								</div>
							</div>
							<!--</i>-->
							<h5 class="card-title mb-2 text-info">Denny Abraham is asking for help</h5>
							<th:block th:if="${need.percentageOfGenuineness != null}">
							<div class="progress md-progress mt-1 w-25 ml-auto float-right">
								<div class="progress-bar warning-color-dark" role="progressbar" th:style="'width:'+ ${need.percentageOfGenuineness}+'%;'" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" th:text="${need.percentageOfGenuineness}+'%'">25% genuine</div>
							</div>
							</th:block>
							<label><p class="px-1 small my-auto pb-0 bg-primary rounded" th:text="category">Category</p></label>
<!-- 							<h5 class="card-title text-info" th:unless="${#lists.isEmpty(need.categories)}" th:text="'category: '+${need.categories[0].name}+'-'+${need.categories[0].subCategory}">Need
								help</h5> -->
							<p class="card-subtitle mb-2 text-muted small mb-3 mt-1" th:text="'posted '+${need.date}">posted just now</p>
							<!-- Grid row -->
							<div class="row">

								<!-- Grid column -->
								<div class="col-md-12 mb-3">

									<img src="https://mdbootstrap.com/img/Photos/Slides/img%20(137).jpg" class="img-fluid z-depth-1" alt="Responsive image">

								</div>
								<!-- Grid column -->

							</div>
							<!-- Grid row -->

							<!-- Grid row -->
							<div class="row">

								<!-- Grid column -->
								<div class="col-lg-4 col-md-12 mb-3">

									<img src="https://mdbootstrap.com/img/Photos/Horizontal/Nature/6-col/img(115).jpg" class="img-fluid z-depth-1"
									 alt="Responsive image">

								</div>
								<!-- Grid column -->

								<!-- Grid column -->
								<div class="col-lg-4 col-md-6 mb-3">

									<img src="https://mdbootstrap.com/img/Photos/Horizontal/Nature/6-col/img(116).jpg" class="img-fluid z-depth-1"
									 alt="Responsive image">

								</div>
								<!-- Grid column -->

								<!-- Grid column -->
								<div class="col-lg-4 col-md-6 mb-3">

									<img src="https://mdbootstrap.com/img/Photos/Horizontal/Nature/6-col/img(117).jpg" class="img-fluid z-depth-1"
									 alt="Responsive image">

								</div>
								<!-- Grid column -->

							</div>
							<!-- Grid row -->

							<!-- Grid row -->
							<div class="row">

								<!-- Grid column -->
								<div class="col-md-6 mb-3">

									<img src="https://mdbootstrap.com/img/Photos/Horizontal/People/6-col/img(117).jpg" class="img-fluid z-depth-1"
									 alt="Responsive image">

								</div>
								<!-- Grid column -->

								<!-- Grid column -->
								<div class="col-md-6 mb-3">

									<img src="https://mdbootstrap.com/img/Photos/Horizontal/People/6-col/img(129).jpg" class="img-fluid z-depth-1"
									 alt="Responsive image">

								</div>
								<!-- Grid column -->

							</div>

<!-- 							<th:block th:each="file,indexStatus : ${need.fileNames}">

									<div class="row">

											<div class="col-md-12 mb-3">
			
												<img src="https://mdbootstrap.com/img/Photos/Slides/img%20(137).jpg" th:src="${file}" class="img-fluid z-depth-1" alt="Responsive image">
			
											</div>
										
			
										</div>
							</th:block> -->

							<!-- Grid row -->
							<p class="card-text mt-2" th:text="${need.description}">Some quick example text to build on the               
								panel title and make up the bulk of the panel's content.</p>

							<div class="text-center col-xs-5 border-bottom border-light">
									<a th:href="@{'/help-need/'+${need.id}}" class="small muted-text" onclick="$('#comments').show();" th:onclick="|viewComments(${need.id})|">0 Comments</a>
									<a th:href="@{'/help-need/'+${need.id}}" class="small muted-text ml-4" th:onclick="|viewHelps(${need.id})|">8 people helped</a>
								</div>
							</div>

							
							<!--<div id="comments" th:id="'comments'+{comment.id}" th:if="${need.commentList != null}" style="display: none;" th:style="display:block;">
								<div class="md-form mt-0 mx-3 form-info">
									<textarea type="text" id="comment-box" class="md-textarea form-control d-inline" rows="1"></textarea>
									<label for="comment-box">Comment here</label>
									<button type="button" class="btn btn-outline-info btn-sm float-right mt-0" th:onclick="|commentOnNeed('${need.id}')|">Submit</button>

								  </div>
									<p class="text-primary text-center mt-5 d-inline ml-5 mb-4">All comments</p><i class="fa fa-angle-up float-right mr-5 mt-1 d-inline" aria-hidden="true" onclick="$('#comments').hide();" th.onlick="|$('#comments-${comment.id}').hide();|"></i>
								<div class="border-light border-bottom" th:each="comment : ${need.comments}">
									<p class="ml-4 mt-2 mb-0">lkkjskdalj</p>
									<p class="text-muted ml-4 small d-inline" th:text="'Siraj commented'+${comment.timeElapsed}">Siraj<span class="large">.</span>3 minutes ago</p>
									<i class="fa fa-reply float-right small text-info mr-5" aria-hidden="true"></i>
								</div>-->
								
<!-- 								<div class="border-light border-bottom">
									<p>lkkjskdalj</p>
								</div>
								<div class="border-light border-bottom">
									<p>lkkjskdalj</p>
								</div> -->
							<!--</div>-->
							<!--<p>
								<a th:href="@{'/needs/'+${need.id}}" class="card-link">Click for more</a> -->
							<div class="row mt-2">
								<div class="text-center col-xs-5 mx-auto">
									<a th:href="@{'/help-need/'+${need.id}}" class="ml-2 card-link text-success float-left">Help now</a>
									<a th:href="@{'/helps/completed'}" class="mt-1 card-link text-success small float-left">Helps received</a>
								</div>	

								<div class="col-xs-7 d-inline mx-auto">
									<button type="button" class="btn btn-rounded young-passion-gradient btn-sm px-3 mt-0 mb-3 float-right" th:onclick="|markFake(${need.id})|">Fake</button>
									<button type="button" class="btn btn-round aqua-gradient btn-sm px-2 float-right mt-0 mb-3" th:onclick="|markGenuine(${need.id})|">Genuine</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="help-post" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true" th:if="${help != null}">
  <div class="modal-dialog" th:fragment="post-help" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Help</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
	  </div>
	  <form th:action="@{/helps}" th:object="${help}" th:method="post">
      <div class="modal-body mx-3">
								<div class="md-form mt-0 mx-3 form-info mb-0">
									<textarea type="text" id="help-post" class="md-textarea form-control" rows="1"
										placeholder="Describe your help here.." th:name="help.description"></textarea>
								</div>

	  </div>
	  <input type=hidden th:name="help.timeInString" th:value="${#dates.format(#dates.createNow(), 'yyyy-MM-dd HH:mm:ss')}">
	  <input type="hidden" th:field="${help.fulfilledNeedId}">
      <div class="modal-footer d-flex justify-content-center">
        <button type="submit" class="btn btn-info">Submit for verification</button>
	  </div>
	  </form>
    </div>
  </div>
</div>
	</div>
	<!-- SCRIPTS -->
	<!-- JQuery -->
	<!-- JQuery -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.13/js/mdb.min.js"></script>
	<script>
		function markGenuine(needId) {
			$.ajax({
  type: 'POST',
  url: 'user-checks/markingGenuineness',
  data: {
      isGenuine: "true",
      checkedNeedId: "1"
  },
  success: function(response) {
    console.log("Book created successfully");
    //document.getElementById("success-message").innerHTML="success";
  },
  error: function() {
    console.log("failed...!");
  }
});
		}
		function markFake(needId) {
			$.ajax({
  type: 'POST',
  url: 'user-checks/markingGenuineness',
  data: {
      isGenuine: "false",
      checkedNeedId: "1"
  },
  success: function(response) {
    console.log("Book created successfully");
    //document.getElementById("success-message").innerHTML="success";
  },
  error: function() {
    console.log("failed...!");
  }
});
		} 
		function viewComments(needId) {
			
		}
		function commentOnNeed() {

		}
	</script>
</body>

</html>